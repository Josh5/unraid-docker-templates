<?xml version="1.0"?>
<Container version="2">
    <Name>dind</Name>
    <Repository>ghcr.io/josh5/ubuntu-dind:latest</Repository>
    <Registry>https://registry.hub.docker.com/_/docker</Registry>
    <Network>eth0</Network>
    <MyIP>192.168.1.201</MyIP>
    <Shell>bash</Shell>
    <Privileged>true</Privileged>
    <Support />
    <Project>https://docs.docker.com/engine/</Project>
    <Overview>Run Docker-in-Docker on Unraid to get a dedicated Docker Engine without modifying the host daemon.
Prerequisites (Unraid + macvlan):
1) In Unraid, open Settings -&gt; Docker.
2) Stop Docker, then set "Docker custom network type" to macvlan.
3) Enable a custom network on eth0 (e.g., "br0" or "eth0" depending on your setup).
4) Assign a fixed IP in the Unraid Docker template (matches the MyIP field). This IP must be
free on your LAN and outside your DHCP pool.
5) Start Docker again.

Template configuration notes:
- Privileged: recommended for best compatibility with nested containers and features like
overlay networking. Not strictly required, but some inner containers may fail without it.
- Hostname and /etc/hosts: update ExtraParams to set a meaningful hostname and host entry:
--hostname='Tower' --add-host='Tower:127.0.0.1'
Replace "Tower" with your Unraid server name or desired node name.
- ExtraParams: you can remove --gpus=1 if you do not want GPU access, or set it to a
specific GPU UUID.

Optional:
- If you want the inner Docker daemon to persist data, ensure the /var/lib/docker path maps
to a stable storage path as configured in the template.
- For TLS client certs or custom daemon config, use the mapped /certs and /etc/docker paths.
- You can set the default runtime by writing /etc/docker/daemon.json in the bound config
path (Path: Docker config). Example:
> {
>     "runtimes": {
>         "nvidia": {
>             "args": [],
>             "path": "nvidia-container-runtime"
>         }
>     }
> }
    </Overview>
    <Category>Productivity: Tools:Utilities Other:</Category>
    <WebUI />
    <TemplateURL>
        https://raw.githubusercontent.com/Josh5/unraid-docker-templates/master/josh5/dind.xml</TemplateURL>
    <Icon>https://djeqr6to3dedg.cloudfront.net/repo-logos/library/docker/live/logo.png</Icon>
    <ExtraParams>--gpus=1 --hostname='Tower' --add-host='Tower:127.0.0.1'</ExtraParams>
    <PostArgs />
    <CPUset />
    <DateInstalled>1712635787</DateInstalled>
    <DonateText />
    <DonateLink />
    <Requires />
    <Config Name="Path: Certificate" Target="/certs"
        Default="/mnt/user/system/dind/certs" Mode="rw" Description="" Type="Path"
        Display="always" Required="false" Mask="false">/mnt/user/system/dind/certs</Config>
    <Config Name="Path: Docker storage" Target="/var/lib/docker"
        Default="/mnt/user/system/dind/var/" Mode="rw" Description="" Type="Path"
        Display="always" Required="false" Mask="false">/var/lib/docker/dind-var/dind</Config>
    <Config Name="Path: Docker config" Target="/etc/docker"
        Default="/mnt/user/system/dind/etc" Mode="rw" Description="" Type="Path"
        Display="always" Required="false" Mask="false">/mnt/user/system/dind/etc</Config>
    <Config Name="Force Insecure TCP" Target="DOCKER_FORCE_INSECURE_TCP" Default="false" Mode=""
        Description="Expose tcp://0.0.0.0:2375 even when TLS is enabled on 2376." Type="Variable"
        Display="always" Required="false" Mask="false">false</Config>
    <Config Name="Path: /mnt" Target="/mnt" Default="" Mode="rw"
        Description="Provides direct access to the mounted disks" Type="Path" Display="always"
        Required="false" Mask="false">/mnt</Config>
    <Config Name="Timezone" Target="TZ" Default="Etc/UTC" Mode="" Description="Container timezone."
        Type="Variable" Display="always" Required="false" Mask="false">Etc/UTC</Config>
    <Config Name="Nvidia GPU UUID" Target="NVIDIA_VISIBLE_DEVICES" Default="all" Mode=""
        Description="For users with multiple GPUs, add the ID found under the " Type="Variable"
        Display="always" Required="false" Mask="false">all</Config>
    <Config Name="Driver Capabilities" Target="NVIDIA_DRIVER_CAPABILITIES" Default="all" Mode=""
        Description="" Type="Variable" Display="always" Required="false" Mask="false">all</Config>
    <TailscaleStateDir />
</Container>
